# ──────────────────────────────────────────────────────────────
#  Copy this file to .env and fill in real values.
#  NEVER commit .env – it is git-ignored.
# ──────────────────────────────────────────────────────────────

PORT=3000

# ── Database ──────────────────────────────────────────────────
# Use the Docker Compose defaults or override with your own credentials.
DATABASE_URL=postgresql://${POSTGRES_USER:-postgres}:${POSTGRES_PASSWORD:-changeme}@localhost:5432/ticketing?schema=public
DIRECT_URL=postgresql://${POSTGRES_USER:-postgres}:${POSTGRES_PASSWORD:-changeme}@localhost:5432/ticketing?schema=public
# Startup retry behavior when database is temporarily unavailable.
DB_CONNECT_MAX_RETRIES=8
DB_CONNECT_INITIAL_DELAY_MS=500
DB_CONNECT_MAX_DELAY_MS=10000
# TTL for schema capability checks (e.g. routing assignee column) before refresh.
SCHEMA_CHECK_CACHE_TTL_MS=300000

# ── CORS / App URLs ──────────────────────────────────────────
CORS_ORIGIN=http://localhost:5173
WEB_APP_URL=http://localhost:5173

# ── API rate limiting ────────────────────────────────────────
# Limit requests per IP in each TTL window (milliseconds).
RATE_LIMIT_LIMIT=120
RATE_LIMIT_TTL_MS=60000
# Explicit HTTP server timeouts.
REQUEST_TIMEOUT_MS=120000
KEEP_ALIVE_TIMEOUT_MS=5000
HEADERS_TIMEOUT_MS=121000

# ── Authentication ────────────────────────────────────────────
# Azure AD / Entra ID is the default auth flow.
# AUTH_ALLOW_INSECURE_HEADERS should remain false in real environments.
AUTH_ALLOW_INSECURE_HEADERS=false
# Optional: custom issuer/JWKS overrides for token validation.
AUTH_JWT_ISSUER=
AUTH_JWKS_URI=
# Optional fallback: HS256 shared-secret bearer tokens (disabled when empty).
AUTH_JWT_SECRET=
AUTH_JWT_AUDIENCE=
# Optional: comma-separated owner emails auto-promoted on sign-in.
AUTH_BOOTSTRAP_OWNER_EMAILS=

# ── Redis ─────────────────────────────────────────────────────
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_URL=

# ── Background queues ────────────────────────────────────────
# Set to "true" only when Redis is available.
NOTIFICATIONS_QUEUE_ENABLED=false
AUTOMATION_QUEUE_ENABLED=false

# ── Attachments ───────────────────────────────────────────────
ATTACHMENTS_DIR=uploads
ATTACHMENTS_MAX_MB=10

# ── SMTP (email sending) ─────────────────────────────────────
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_SECURE=false
SMTP_FROM=no-reply@localhost

# ── Azure AD / Entra ID (SSO) ────────────────────────────────
AZURE_TENANT_ID=
AZURE_CLIENT_ID=
AZURE_CLIENT_SECRET=

# ── Microsoft 365 (Email ingestion) ──────────────────────────
M365_TENANT_ID=
M365_CLIENT_ID=
M365_CLIENT_SECRET=
M365_INBOUND_WEBHOOK_SECRET=
